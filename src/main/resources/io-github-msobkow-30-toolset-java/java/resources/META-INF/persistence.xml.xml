<?xml version="1.0" encoding="UTF-8"?>
<!--
 *	Mark's Code Fractal CFKBase 3.1 Code Fractal Knowledge Base
 *
 *	Copyright 2016-2026 Mark Stephen Sobkow
 *
 *	This file is part of Mark's Code Fractal CFKBase.
 *
 *	Mark's Code Fractal CFKBase is available under dual commercial license from
 *	Mark Stephen Sobkow, or under the terms of the GNU General Public License,
 *	Version 3 or later.
 *
 *	Mark's Code Fractal CFKBase is free software: you can redistribute it and/or
 *	modify it under the terms of the GNU General Public License as published by
 *	the Free Software Foundation, either version 3 of the License, or
 *	(at your option) any later version.
 *
 *	Mark's Code Fractal CFKBase is distributed in the hope that it will be useful,
 *	but WITHOUT ANY WARRANTY; without even the implied warranty of
 *	MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *	GNU General Public License for more details.
 *
 *	You should have received a copy of the GNU General Public License
 *	along with Mark's Code Fractal CFKBase.  If not, see &lt;https://www.gnu.org/licenses/&gt;.
 *
 *	If you wish to modify and use this code without publishing your changes,
 *	or integrate it with proprietary code, please contact Mark Stephen Sobkow
 *	for a commercial license at mark.sobkow@gmail.com
 * -->
<RuleSet
	xmlns="https://msobkow.github.io/msscf/2.0.13/xsd/cfgenkb-2.13-ruleset.xsd"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:xs="http://www.w3.org/2001/XMLSchema"
	xsi:schemaLocation="https://msobkow.github.io/msscf/2.0.13/xsd/cfgenkb-2.13-ruleset.xsd https://msobkow.github.io/msscf/2.0.13/xsd/cfgenkb-2.13-ruleset.xsd"
	ToolSet="java"
	Name="resources/META-INF/persistence.xml"
	Revision="3.0"
	Descr="Persistence layer configuration">

	<GenFile GenDef="SchemaDef" Name="fileResourcesMetaInfPersistenceXml"
			GenerateOnce="false"
		ModuleName="$reference ManufacturingSchema lower JavaPackage$"
		SourceBundle="java"
		BasePackageName="$reference ManufacturingSchema lower JavaPackage$.$reference ManufacturingSchema lower SchemaName$jpa/src/main/resources"
		SubPackageName="META-INF"
		ExpansionClassName="$SchemaName$MetaInfPersistenceXml"
		ExpansionKeyName="$SchemaName$MetaInfPersistenceXml"
		ExpansionFileName="persistence.xml"
>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence xmlns="https://jakarta.ee/xml/ns/persistence"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="https://jakarta.ee/xml/ns/persistence https://jakarta.ee/xml/ns/persistence/persistence_3_0.xsd"
             version="3.0"&gt;$PersistenceXmlPersistenceUnit$
&lt;/persistence&gt;
</GenFile>

<GenRule GenDef="SchemaRef" Name="PersistenceXmlPersistenceUnit">$reference RefSchema PersistenceXmlPersistenceUnit$</GenRule>

<GenRule GenDef="SchemaDef" Name="PersistenceXmlPersistenceUnit">
    &lt;persistence-unit name="$DbSchemaName$PU" transaction-type="RESOURCE_LOCAL"&gt;$iterate Tables( each maybePersistenceUnitTableClass )$
        &lt;properties&gt;
            &lt;!-- Example properties, adjust for your DBMS --&gt;
            &lt;property name="hibernate.transaction.jta.platform" value="org.hibernate.engine.transaction.jta.platform.internal.SpringJtaPlatform"/&gt;
            &lt;property name="jakarta.persistence.jdbc.url" value="jdbc:postgresql://localhost:5432/$lower DbSchemaName$"/&gt;
            &lt;property name="jakarta.persistence.jdbc.user" value="youruser"/&gt;
            &lt;property name="jakarta.persistence.jdbc.password" value="yourpassword"/&gt;
            &lt;property name="hibernate.dialect" value="org.hibernate.dialect.PostgreSQLDialect"/&gt;
            &lt;property name="hibernate.hbm2ddl.auto" value="update"/&gt;
            &lt;property name="hibernate.show_sql" value="false"/&gt;
        &lt;/properties&gt;
    &lt;/persistence-unit&gt;
</GenRule>

<GenRule GenDef="Table" Name="maybePersistenceUnitTableClass">$switch HasDefSchema yes empty default PersistenceUnitTableClass$</GenRule>

<GenRule GenDef="Table" Name="PersistenceUnitTableClass">
        &lt;class&gt;$lower DefTopProjectName$.$lower DefVUnderVersion$.$lower DefSubProjectName$.$lower DefSchemaName$.jpa.$DefSchemaName$Jpa$TableName$&lt;/class&gt;$switch BaseHasHistory yes alsoPUTableHistoryClass default empty$</GenRule>
<GenRule GenDef="Table" Name="alsoPUTableHistoryClass">
        &lt;class&gt;$lower DefTopProjectName$.$lower DefVUnderVersion$.$lower DefSubProjectName$.$lower DefSchemaName$.jpa.$DefSchemaName$Jpa$TableName$H&lt;/class&gt;</GenRule>

<GenRule GenDef="Object" Name="DefJavaPackage">$switch HasDefSchema yes derefDefSchemaJavaPackage default mySchemaJavaPackage$</GenRule>

<GenRule GenDef="Object" Name="derefDefSchemaJavaPackage">$reference DefSchema JavaPackage$</GenRule>

<GenRule GenDef="Object" Name="mySchemaJavaPackage">$JavaPackage$</GenRule>

</RuleSet>
